<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Perfil de Recrutamento - Empregador</title>
    <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gray-100 font-sans leading-normal tracking-normal">

    <div id="employerQuestionnaire" class="container mx-auto max-w-2xl mt-10 p-8 bg-white rounded-lg shadow-xl">
        <h1 class="text-3xl font-bold text-blue-600 text-center mb-6">Questionário de Perfil da Empresa</h1>
        <p class="text-gray-700 text-center mb-8">
            Avalie o perfil de candidato ideal para sua empresa, ajustando as barras de acordo com a sua preferência.
            A pontuação mais alta indica maior prioridade.
        </p>

        <form id="employerForm" class="space-y-6">

            <div class="p-6 bg-gray-50 rounded-lg shadow-sm">
                <p class="text-lg font-semibold text-gray-800 mb-2">
                    Prioridade no perfil **Inovador**
                </p>
                <p class="text-gray-600 text-sm mb-4">
                    Busca por adaptabilidade, proatividade e busca por soluções criativas.
                </p>
                <div class="flex flex-col md:flex-row md:items-center md:justify-between">
                    <p class="text-sm text-gray-600 flex-shrink-0 mb-2 md:mb-0">Menos Importante</p>
                    <input type="range" name="inovadorScore" min="1" max="5" value="3" class="w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer">
                    <p class="text-sm text-gray-600 flex-shrink-0 mt-2 md:mt-0">Mais Importante</p>
                </div>
                <p class="text-center mt-2 text-gray-500">
                    <span class="font-bold">Pontuação:</span> <span id="inovadorScoreValue">3</span>
                </p>
            </div>

            <div class="p-6 bg-gray-50 rounded-lg shadow-sm">
                <p class="text-lg font-semibold text-gray-800 mb-2">
                    Prioridade no perfil **Executor Estratégico**
                </p>
                <p class="text-gray-600 text-sm mb-4">
                    Busca por foco, colaboração, atenção aos processos e execução eficiente de tarefas.
                </p>
                <div class="flex flex-col md:flex-row md:items-center md:justify-between">
                    <p class="text-sm text-gray-600 flex-shrink-0 mb-2 md:mb-0">Menos Importante</p>
                    <input type="range" name="executorScore" min="1" max="5" value="3" class="w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer">
                    <p class="text-sm text-gray-600 flex-shrink-0 mt-2 md:mt-0">Mais Importante</p>
                </div>
                <p class="text-center mt-2 text-gray-500">
                    <span class="font-bold">Pontuação:</span> <span id="executorScoreValue">3</span>
                </p>
            </div>

            <div class="text-center mt-8">
                <button type="button" onclick="submitEmployerResults()" id="submitEmployerButton" class="w-full bg-blue-600 hover:bg-blue-700 text-white font-bold py-3 px-6 rounded-lg transition duration-200">
                    Finalizar Avaliação
                </button>
            </div>
        </form>

        <div id="statusMessage" class="hidden text-center mt-6 p-4 rounded-lg"></div>

    </div>

    <script>
        document.getElementById('employerForm').addEventListener('input', function(event) {
            const target = event.target;
            if (target.name === 'inovadorScore') {
                document.getElementById('inovadorScoreValue').innerText = target.value;
            } else if (target.name === 'executorScore') {
                document.getElementById('executorScoreValue').innerText = target.value;
            }
        });
    </script>

    <script>
        window.submitEmployerResults = async function() {
            const form = document.getElementById('employerForm');
            const submitButton = document.getElementById('submitEmployerButton');
            const statusMessage = document.getElementById('statusMessage');

            submitButton.disabled = true;
            submitButton.classList.remove('bg-blue-600', 'hover:bg-blue-700');
            submitButton.classList.add('bg-gray-400', 'cursor-not-allowed');

            const inovadorScore = parseInt(form.querySelector('input[name="inovadorScore"]').value, 10);
            const executorScore = parseInt(form.querySelector('input[name="executorScore"]').value, 10);

            let profile = "", description = "";

            if (inovadorScore > executorScore) {
                profile = "Inovador";
                description = "Sua empresa tem um perfil inovador, buscando soluções criativas e valorizando a autonomia. Você busca colaboradores que sejam agentes de mudança.";
            } else if (executorScore > inovadorScore) {
                profile = "Executor Estratégico";
                description = "Sua empresa tem um perfil executor, com foco na eficiência, colaboração e processos bem definidos. Você busca colaboradores que garantam a execução das tarefas.";
            } else {
                profile = "Equilibrado";
                description = "Sua empresa tem um perfil equilibrado, valorizando tanto a inovação quanto a execução. Você busca colaboradores que se adaptem a ambas as necessidades.";
            }

            try {
                const response = await fetch('/.netlify/functions/saveEmployerProfile', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        profile: profile,
                        description: description,
                        inovadorScore: inovadorScore,
                        executorScore: executorScore
                    })
                });

                if (!response.ok) throw new Error('Erro ao salvar os dados.');

                statusMessage.classList.remove('hidden');
                statusMessage.classList.add('bg-green-100', 'text-green-800');
                statusMessage.innerHTML = `
                    <p class="font-bold text-lg">Perfil da Empresa Salvo com Sucesso!</p>
                    <p class="mt-2 text-md">Perfil: ${profile}</p>
                    <p class="mt-2 text-md">Descrição: ${description}</p>
                    <button onclick="window.location.href = 'index.html';" class="w-full bg-blue-600 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded-lg transition duration-200 mt-4">Voltar ao Início</button>
                `;
                form.classList.add('hidden');

            } catch (e) {
                console.error("Erro ao salvar o resultado: ", e);
                statusMessage.classList.remove('hidden');
                statusMessage.classList.add('bg-red-100', 'text-red-800');
                statusMessage.innerHTML = `<p class="font-bold text-lg">Houve um erro ao salvar os dados. Por favor, tente novamente.</p>`;
                submitButton.disabled = false;
                submitButton.classList.remove('bg-gray-400', 'cursor-not-allowed');
                submitButton.classList.add('bg-blue-600', 'hover:bg-blue-700');
            }
        };
    </script>
</body>
</html>
